# Architecture Technique ComplÃ¨te - AgenticAI V4

**Version:** 4.0.0
**Date:** 26 Janvier 2025

---

## ğŸ“‹ Table des MatiÃ¨res

1. [Vue d'Ensemble](#vue-densemble)
2. [Architecture en Couches](#architecture-en-couches)
3. [SchÃ©mas Techniques](#schÃ©mas-techniques)
4. [Flux de DonnÃ©es](#flux-de-donnÃ©es)
5. [Stack Technique](#stack-technique)
6. [Base de DonnÃ©es](#base-de-donnÃ©es)
7. [Orchestration](#orchestration)
8. [Agents](#agents)
9. [SÃ©curitÃ©](#sÃ©curitÃ©)
10. [DÃ©ploiement](#dÃ©ploiement)

---

## 1. Vue d'Ensemble

### Principe Fondamental

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                               â”‚
â”‚   Utilisateur interagit via UI (Web/Mobile/Voice/WhatsApp)  â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ORCHESTRATION LAYER                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚          MASTER ORCHESTRATOR                     â”‚       â”‚
â”‚  â”‚  â€¢ Politiques globales                           â”‚       â”‚
â”‚  â”‚  â€¢ Arbitrage ressources                          â”‚       â”‚
â”‚  â”‚  â€¢ Quotas & garde-fous                           â”‚       â”‚
â”‚  â”‚  â€¢ Validation crÃ©ation agents                     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚              â”‚                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      â”‚              â”‚              â”‚   â”‚
â”‚   â–¼                      â–¼              â–¼              â–¼   â”‚
â”‚  Voice                  Mail           RAG           Coach  â”‚
â”‚  Sub-Orch            Sub-Orch       Sub-Orch      Sub-Orch â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚                      â”‚              â”‚              â”‚
    â–¼                      â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AGENTS LAYER                            â”‚
â”‚  Voice.Capture      Mail.Ingest      RAG.Indexer         â”‚
â”‚  Voice.Transcribe   Mail.Classify    RAG.Searcher        â”‚
â”‚  Voice.Translate    Mail.Summarize   RAG.Citation        â”‚
â”‚  Voice.QA           Mail.Reply       Writer.Academic     â”‚
â”‚                     Web.Search       Reviewer.*          â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                      â”‚              â”‚
    â–¼                      â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SERVICES LAYER                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Ollama  â”‚  â”‚ Postgres â”‚  â”‚ Qdrant â”‚  â”‚  Redis   â”‚    â”‚
â”‚  â”‚ (LLM)   â”‚  â”‚  (SQL)   â”‚  â”‚(Vector)â”‚  â”‚  (Bus)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CaractÃ©ristiques ClÃ©s

âœ… **100% Local** - Tous les modÃ¨les IA via Ollama
âœ… **Modulaire** - Ajout features sans casser existant
âœ… **Scalable** - Orchestration adaptative
âœ… **Observable** - Logs, traces, mÃ©triques
âœ… **SÃ©curisÃ©** - RBAC, audit trail, chiffrement

---

## 2. Architecture en Couches

### 2.1 Couche PrÃ©sentation (Layer 1)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PRESENTATION LAYER                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Web App    â”‚  â”‚   WhatsApp   â”‚  â”‚    Voice     â”‚    â”‚
â”‚  â”‚  (Next.js)   â”‚  â”‚     Bot      â”‚  â”‚   Widget     â”‚    â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚   (Overlay)  â”‚    â”‚
â”‚  â”‚ â€¢ Dashboard  â”‚  â”‚ â€¢ Webhook    â”‚  â”‚ â€¢ Subtitles  â”‚    â”‚
â”‚  â”‚ â€¢ Chat       â”‚  â”‚ â€¢ Commands   â”‚  â”‚ â€¢ Controls   â”‚    â”‚
â”‚  â”‚ â€¢ Settings   â”‚  â”‚ â€¢ Logs       â”‚  â”‚ â€¢ Markers    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                            â”‚                                â”‚
â”‚                            â–¼                                â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                   â”‚   API Gateway   â”‚                      â”‚
â”‚                   â”‚   (FastAPI)     â”‚                      â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Protocoles:
- HTTP/REST (API classique)
- WebSocket (temps rÃ©el: chat, voix)
- Webhook (WhatsApp, intÃ©grations externes)
```

### 2.2 Couche Orchestration (Layer 2)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ORCHESTRATION LAYER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          MASTER ORCHESTRATOR                           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  ResponsabilitÃ©s:                                       â”‚  â”‚
â”‚  â”‚  â€¢ Load Policies (YAML)                                â”‚  â”‚
â”‚  â”‚  â€¢ Validate Agent Creation Requests                    â”‚  â”‚
â”‚  â”‚  â€¢ Arbitrate Resource Conflicts                        â”‚  â”‚
â”‚  â”‚  â€¢ Enforce Quotas & Rate Limits                        â”‚  â”‚
â”‚  â”‚  â€¢ Monitor System Health                               â”‚  â”‚
â”‚  â”‚  â€¢ Emergency Panic Switch                              â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Policies:                                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ max_concurrent_agents: 12                        â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ creation_rate_limit_per_min: 3                   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ guarded_actions:                                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   - send_email_external                          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   - delete_content                               â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ require_human_approval:                          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   - send_email_external                          â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                       â”‚                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚                  â”‚                               â”‚      â”‚
â”‚    â–¼                  â–¼                               â–¼      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Voice         â”‚  â”‚ Mail          â”‚  â”‚ RAG/Chat      â”‚   â”‚
â”‚  â”‚ Sub-Orch      â”‚  â”‚ Sub-Orch      â”‚  â”‚ Sub-Orch      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ Capture     â”‚  â”‚ â€¢ Ingest      â”‚  â”‚ â€¢ Index       â”‚   â”‚
â”‚  â”‚ â€¢ Transcribe  â”‚  â”‚ â€¢ Classify    â”‚  â”‚ â€¢ Search      â”‚   â”‚
â”‚  â”‚ â€¢ Translate   â”‚  â”‚ â€¢ Summarize   â”‚  â”‚ â€¢ Cite        â”‚   â”‚
â”‚  â”‚ â€¢ QA          â”‚  â”‚ â€¢ Reply       â”‚  â”‚ â€¢ Generate    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Coach         â”‚  â”‚ Writer        â”‚  â”‚ Web           â”‚   â”‚
â”‚  â”‚ Sub-Orch      â”‚  â”‚ Sub-Orch      â”‚  â”‚ Sub-Orch      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ Log Ingest  â”‚  â”‚ â€¢ Academic    â”‚  â”‚ â€¢ Search      â”‚   â”‚
â”‚  â”‚ â€¢ Analyst     â”‚  â”‚ â€¢ CR          â”‚  â”‚ â€¢ Scrape      â”‚   â”‚
â”‚  â”‚ â€¢ Reporter    â”‚  â”‚ â€¢ Reviewer    â”‚  â”‚ â€¢ Fact-Check  â”‚   â”‚
â”‚  â”‚ â€¢ Alerter     â”‚  â”‚ â€¢ Citation    â”‚  â”‚ â€¢ Monitor     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚  Communication:                                               â”‚
â”‚  â€¢ Event Bus (Redis Streams)                                 â”‚
â”‚  â€¢ Message Queue (Celery/Redis)                              â”‚
â”‚  â€¢ Shared State (Postgres)                                   â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Couche Agents (Layer 3)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AGENTS LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  Structure d'un Agent:                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Agent: voice.transcribe                               â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Metadata:                                             â”‚  â”‚
â”‚  â”‚  â€¢ name: "Voice Transcribe"                            â”‚  â”‚
â”‚  â”‚  â€¢ domain: "voice"                                     â”‚  â”‚
â”‚  â”‚  â€¢ skills: [speech_to_text, multilingual]             â”‚  â”‚
â”‚  â”‚  â€¢ latency_ms: 2000                                    â”‚  â”‚
â”‚  â”‚  â€¢ cost: high                                          â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Models:                                                â”‚  â”‚
â”‚  â”‚  â€¢ whisper:large-v3 (Ollama)                           â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Config:                                                â”‚  â”‚
â”‚  â”‚  â€¢ language: auto                                       â”‚  â”‚
â”‚  â”‚  â€¢ task: transcribe                                     â”‚  â”‚
â”‚  â”‚  â€¢ beam_size: 5                                         â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Lifecycle:                                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ Created  â”‚â”€>â”‚ Running â”‚â”€>â”‚ Paused  â”‚â”€>â”‚ Stopped â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Input/Output:                                          â”‚  â”‚
â”‚  â”‚  Input: audio_stream (bytes)                           â”‚  â”‚
â”‚  â”‚  Output: transcript_text (string + timestamps)         â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Monitoring:                                            â”‚  â”‚
â”‚  â”‚  â€¢ Latency tracking                                     â”‚  â”‚
â”‚  â”‚  â€¢ Error rate                                           â”‚  â”‚
â”‚  â”‚  â€¢ Resource usage (GPU/CPU)                            â”‚  â”‚
â”‚  â”‚  â€¢ Audit trail (all actions logged)                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚
â”‚  Agent Types (28 agents total):                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Voice (4)    â”‚ Mail (5)     â”‚ RAG (3)      â”‚             â”‚
â”‚  â”‚ Coach (4)    â”‚ Writer (2)   â”‚ Reviewer (3) â”‚             â”‚
â”‚  â”‚ Web (4)      â”‚ Custom (3+)  â”‚              â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                â”‚
â”‚  Registry:                                                    â”‚
â”‚  â€¢ Stored in config/agents/registry.yaml                     â”‚
â”‚  â€¢ Loaded at startup                                          â”‚
â”‚  â€¢ Dynamically extensible                                     â”‚
â”‚  â€¢ Versioned                                                  â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 Couche Services (Layer 4)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICES LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚     OLLAMA        â”‚  â”‚    POSTGRESQL     â”‚               â”‚
â”‚  â”‚  (AI Models)      â”‚  â”‚  (Structured DB)  â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚ LLM:              â”‚  â”‚ Tables:           â”‚               â”‚
â”‚  â”‚ â€¢ qwen2.5:14b     â”‚  â”‚ â€¢ agents          â”‚               â”‚
â”‚  â”‚ â€¢ phi4:latest     â”‚  â”‚ â€¢ orchestrators   â”‚               â”‚
â”‚  â”‚ â€¢ qwen2.5-coder   â”‚  â”‚ â€¢ events          â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚ â€¢ documents       â”‚               â”‚
â”‚  â”‚ Embeddings:       â”‚  â”‚ â€¢ emails          â”‚               â”‚
â”‚  â”‚ â€¢ nomic-embed-textâ”‚  â”‚ â€¢ health_logs     â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚ â€¢ templates       â”‚               â”‚
â”‚  â”‚ ASR:              â”‚  â”‚ â€¢ users           â”‚               â”‚
â”‚  â”‚ â€¢ whisper:large-v3â”‚  â”‚ â€¢ policies        â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚                   â”‚               â”‚
â”‚  â”‚ Multimodal:       â”‚  â”‚ Features:         â”‚               â”‚
â”‚  â”‚ â€¢ llava:13b       â”‚  â”‚ â€¢ ACID            â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚ â€¢ Migrations      â”‚               â”‚
â”‚  â”‚ API: :11434       â”‚  â”‚ â€¢ Backups         â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ Port: 5432      â”‚               â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚     QDRANT        â”‚  â”‚      REDIS        â”‚               â”‚
â”‚  â”‚  (Vector DB)      â”‚  â”‚  (Cache/Bus)      â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚ Collections:      â”‚  â”‚ Uses:             â”‚               â”‚
â”‚  â”‚ â€¢ agenticai_rag   â”‚  â”‚ â€¢ Cache           â”‚               â”‚
â”‚  â”‚ â€¢ voice_trans     â”‚  â”‚ â€¢ Event Bus       â”‚               â”‚
â”‚  â”‚ â€¢ mail_threads    â”‚  â”‚ â€¢ Celery Broker   â”‚               â”‚
â”‚  â”‚ â€¢ documents       â”‚  â”‚ â€¢ Session Store   â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚ â€¢ Rate Limiting   â”‚               â”‚
â”‚  â”‚ Features:         â”‚  â”‚                   â”‚               â”‚
â”‚  â”‚ â€¢ Cosine distance â”‚  â”‚ Structures:       â”‚               â”‚
â”‚  â”‚ â€¢ Hybrid search   â”‚  â”‚ â€¢ Streams         â”‚               â”‚
â”‚  â”‚ â€¢ Filters         â”‚  â”‚ â€¢ Pub/Sub         â”‚               â”‚
â”‚  â”‚ â€¢ Dashboard       â”‚  â”‚ â€¢ Sorted Sets     â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚                   â”‚               â”‚
â”‚  â”‚ API: :6333        â”‚  â”‚ Port: 6379        â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚     MINIO         â”‚  â”‚     CELERY        â”‚               â”‚
â”‚  â”‚ (Object Storage)  â”‚  â”‚  (Task Queue)     â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚ Buckets:          â”‚  â”‚ Queues:           â”‚               â”‚
â”‚  â”‚ â€¢ audio-files     â”‚  â”‚ â€¢ voice.high      â”‚               â”‚
â”‚  â”‚ â€¢ transcripts     â”‚  â”‚ â€¢ mail.medium     â”‚               â”‚
â”‚  â”‚ â€¢ documents       â”‚  â”‚ â€¢ rag.low         â”‚               â”‚
â”‚  â”‚ â€¢ exports         â”‚  â”‚ â€¢ coach.scheduled â”‚               â”‚
â”‚  â”‚ â€¢ backups         â”‚  â”‚                   â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚ Workers:          â”‚               â”‚
â”‚  â”‚ Features:         â”‚  â”‚ â€¢ 4 concurrent    â”‚               â”‚
â”‚  â”‚ â€¢ S3 compatible   â”‚  â”‚ â€¢ Auto-retry      â”‚               â”‚
â”‚  â”‚ â€¢ Versioning      â”‚  â”‚ â€¢ Priority        â”‚               â”‚
â”‚  â”‚ â€¢ Encryption      â”‚  â”‚                   â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚ Beat:             â”‚               â”‚
â”‚  â”‚ API: :9000        â”‚  â”‚ â€¢ Scheduled tasks â”‚               â”‚
â”‚  â”‚ Console: :9001    â”‚  â”‚ â€¢ Cron-like       â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.5 Couche ObservabilitÃ© (Layer 5)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 OBSERVABILITY LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   JAEGER          â”‚  â”‚   PROMETHEUS      â”‚               â”‚
â”‚  â”‚ (Tracing)         â”‚  â”‚  (Metrics)        â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚ â€¢ Distributed     â”‚  â”‚ Metrics:          â”‚               â”‚
â”‚  â”‚   traces          â”‚  â”‚ â€¢ Latency         â”‚               â”‚
â”‚  â”‚ â€¢ Span analysis   â”‚  â”‚ â€¢ Throughput      â”‚               â”‚
â”‚  â”‚ â€¢ Dependency      â”‚  â”‚ â€¢ Error rate      â”‚               â”‚
â”‚  â”‚   graph           â”‚  â”‚ â€¢ Resource usage  â”‚               â”‚
â”‚  â”‚ â€¢ UI: :16686      â”‚  â”‚ â€¢ Custom counters â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ API: :9090      â”‚               â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   GRAFANA         â”‚  â”‚   LOGS            â”‚               â”‚
â”‚  â”‚  (Dashboards)     â”‚  â”‚ (Structured JSON) â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚ Dashboards:       â”‚  â”‚ Levels:           â”‚               â”‚
â”‚  â”‚ â€¢ System overview â”‚  â”‚ â€¢ DEBUG           â”‚               â”‚
â”‚  â”‚ â€¢ Agent metrics   â”‚  â”‚ â€¢ INFO            â”‚               â”‚
â”‚  â”‚ â€¢ Voice latency   â”‚  â”‚ â€¢ WARNING         â”‚               â”‚
â”‚  â”‚ â€¢ Mail throughput â”‚  â”‚ â€¢ ERROR           â”‚               â”‚
â”‚  â”‚ â€¢ RAG performance â”‚  â”‚ â€¢ CRITICAL        â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚                   â”‚               â”‚
â”‚  â”‚ Alerts:           â”‚  â”‚ Fields:           â”‚               â”‚
â”‚  â”‚ â€¢ Email           â”‚  â”‚ â€¢ timestamp       â”‚               â”‚
â”‚  â”‚ â€¢ Webhook         â”‚  â”‚ â€¢ level           â”‚               â”‚
â”‚  â”‚ â€¢ Slack           â”‚  â”‚ â€¢ agent_id        â”‚               â”‚
â”‚  â”‚                   â”‚  â”‚ â€¢ action          â”‚               â”‚
â”‚  â”‚ UI: :3001         â”‚  â”‚ â€¢ duration_ms     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ error_message   â”‚               â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. SchÃ©mas Techniques

### 3.1 Flux Voix Temps RÃ©el

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FLUX VOIX TEMPS RÃ‰EL                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Utilisateur parle
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Micro     â”‚  Audio brut (PCM 16kHz mono)
â”‚  (Browser)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ WebSocket
       â”‚ Chunks 100ms
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Voice.Capture Agent    â”‚  VAD + Buffer
â”‚ (Backend)              â”‚  Packets 1-2s
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Audio packets
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Voice.Transcribe Agent â”‚  whisper:large-v3
â”‚ (Ollama)               â”‚  Latency: ~2s
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Text + Timestamps
       â–¼
    â”Œâ”€â”€â”´â”€â”€â”€â”
    â”‚      â”‚
    â–¼      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Display â”‚ â”‚Voice.Translate   â”‚  qwen2.5:14b
â”‚Subtitlesâ”‚ â”‚Agent (Ollama)    â”‚  Latency: ~1s
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Translated text
                  â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Display      â”‚
           â”‚ Translation  â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ RAG.Indexer      â”‚  nomic-embed-text
           â”‚ (Background)     â”‚  Chunking + Embeddings
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Vectors
                  â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   Qdrant     â”‚  Indexed for Q&A
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Query
                  â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Voice.QA Agent   â”‚  RAG + qwen2.5:14b
           â”‚                  â”‚  Latency: ~2s
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Answer + Citations
                  â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚    Display   â”‚
           â”‚    Answer    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total latency (parole â†’ sous-titre): 3-4s
Total latency (parole â†’ traduction): 4-5s
Total latency (question â†’ rÃ©ponse): 2-3s
```

### 3.2 Flux E-mail

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUX E-MAIL                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gmail/Outlookâ”‚  OAuth2 Connection
â”‚   Account    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ API Call (every 5 min)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mail.Ingest Agent      â”‚  Fetch threads + metadata
â”‚                        â”‚  Batch: 50 emails
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Email threads
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mail.Classify Agent    â”‚  phi4:latest
â”‚                        â”‚  Priority + Theme + Sentiment
â”‚                        â”‚  Latency: ~500ms/email
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Classified threads
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Postgres DB          â”‚  Store metadata + labels
â”‚   (emails table)       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ User request: "Summarize finance emails"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mail.Summarize Agent   â”‚  qwen2.5:14b
â”‚                        â”‚  â€¢ Bullets
â”‚                        â”‚  â€¢ Risks
â”‚                        â”‚  â€¢ Next steps
â”‚                        â”‚  Latency: ~3s/thread
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Summary
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Display UI         â”‚  Show summary
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ User: "Reply to this"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mail.ReplyDraft Agent  â”‚  qwen2.5:14b
â”‚                        â”‚  â€¢ Context-aware
â”‚                        â”‚  â€¢ Tone: professional
â”‚                        â”‚  â€¢ Length: medium
â”‚                        â”‚  Latency: ~2s
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Draft email
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HITL Approval          â”‚  Human validates draft
â”‚ (UI)                   â”‚  Edit if needed
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Approved
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mail.Send Agent        â”‚  Send via Gmail/Outlook API
â”‚                        â”‚  Log to audit trail
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Sent confirmation
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RAG.Indexer            â”‚  Index email content
â”‚ (Background)           â”‚  for future search
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Flux RÃ©daction AcadÃ©mique

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FLUX RÃ‰DACTION ACADÃ‰MIQUE (Boucle ItÃ©rative)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User: "Write a 10-page research report on AI ethics"
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Writer Sub-Orchestratorâ”‚  Parse request
â”‚                        â”‚  Plan outline
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Outline + Notes
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Writer.Academic Agent  â”‚  qwen2.5:14b
â”‚ (ITERATION 1)          â”‚  Generate full draft
â”‚                        â”‚  â€¢ Introduction
â”‚                        â”‚  â€¢ Sections 1-5
â”‚                        â”‚  â€¢ Conclusion
â”‚                        â”‚  â€¢ References
â”‚                        â”‚  Latency: ~30s
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Draft v1
       â–¼
    â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                  â”‚
    â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Reviewer.         â”‚      â”‚Reviewer.         â”‚
â”‚Hallucination     â”‚      â”‚Citation          â”‚
â”‚Agent             â”‚      â”‚Agent             â”‚
â”‚                  â”‚      â”‚                  â”‚
â”‚Check:            â”‚      â”‚Check:            â”‚
â”‚â€¢ Internal        â”‚      â”‚â€¢ Format (APA)    â”‚
â”‚  consistency     â”‚      â”‚â€¢ DOI exists      â”‚
â”‚â€¢ Fact accuracy   â”‚      â”‚â€¢ Complete refs   â”‚
â”‚â€¢ Confidence      â”‚      â”‚                  â”‚
â”‚                  â”‚      â”‚                  â”‚
â”‚Latency: ~5s      â”‚      â”‚Latency: ~2s      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                         â”‚
       â”‚ Issues found            â”‚ Issues found
       â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Reviewer.Style Agent             â”‚
â”‚                                      â”‚
â”‚     Check:                           â”‚
â”‚     â€¢ Academic tone                  â”‚
â”‚     â€¢ Passive voice                  â”‚
â”‚     â€¢ Sentence length                â”‚
â”‚     â€¢ Paragraph structure            â”‚
â”‚                                      â”‚
â”‚     Latency: ~3s                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Combined issues report
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Aggregated Issues      â”‚  â€¢ 3 hallucinations detected
â”‚                        â”‚  â€¢ 2 citations incomplete
â”‚                        â”‚  â€¢ 5 style improvements
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ IF issues > threshold
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Writer.Academic Agent  â”‚  Re-write problematic sections
â”‚ (ITERATION 2)          â”‚  Fix issues found by reviewers
â”‚                        â”‚  Latency: ~15s
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Draft v2
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reviewers (again)      â”‚  Check fixes
â”‚                        â”‚  Latency: ~10s
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ IF issues < threshold
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Final Document         â”‚  â€¢ Markdown
â”‚ Export                 â”‚  â€¢ PDF (via LaTeX)
â”‚                        â”‚  â€¢ Docx
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Max iterations: 3
Total time (10 pages): ~2-3 minutes
```

### 3.4 Flux Recherche Web + Fact-Checking

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            FLUX RECHERCHE WEB + FACT-CHECKING                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Agent needs info: "What is the current population of France?"
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Web.Search Agent       â”‚  Query: "France population 2025"
â”‚                        â”‚
â”‚ Engines:               â”‚
â”‚ â€¢ DuckDuckGo           â”‚
â”‚ â€¢ Brave Search         â”‚
â”‚ â€¢ SearxNG (local)      â”‚
â”‚                        â”‚
â”‚ Latency: ~2s           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Top 20 results (URLs + snippets)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Deduplicate & Rank     â”‚  Remove duplicates
â”‚                        â”‚  Score by relevance
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Top 5 unique URLs
       â–¼
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
   â”‚        â”‚
   â–¼        â–¼ (parallel)
â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚Scrapeâ”‚ â”‚Scrapeâ”‚ â”‚Scrapeâ”‚ â”‚Scrapeâ”‚ â”‚Scrapeâ”‚
â”‚ URL1 â”‚ â”‚ URL2 â”‚ â”‚ URL3 â”‚ â”‚ URL4 â”‚ â”‚ URL5 â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜
   â”‚        â”‚        â”‚        â”‚        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ Clean text from all sources
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Web.FactChecker Agent  â”‚  qwen2.5:14b
â”‚                        â”‚
â”‚ Compare sources:       â”‚
â”‚ â€¢ Extract claims       â”‚
â”‚ â€¢ Find consensus       â”‚
â”‚ â€¢ Flag conflicts       â”‚
â”‚ â€¢ Score confidence     â”‚
â”‚                        â”‚
â”‚ Latency: ~5s           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Fact-check report
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Result:                â”‚
â”‚                        â”‚
â”‚ Claim: "France pop     â”‚
â”‚         ~68M in 2025"  â”‚
â”‚                        â”‚
â”‚ Confidence: 95%        â”‚
â”‚                        â”‚
â”‚ Sources:               â”‚
â”‚ â€¢ insee.fr (official)  â”‚
â”‚ â€¢ worldbank.org        â”‚
â”‚ â€¢ wikipedia.org        â”‚
â”‚                        â”‚
â”‚ Consensus: TRUE        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Result + sources
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RAG.Indexer            â”‚  Index verified facts
â”‚ (Background)           â”‚  for future queries
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total time: ~10s
Confidence: HIGH (3+ trusted sources agree)
```

---

## 4. Stack Technique DÃ©taillÃ©

### Backend

```yaml
Language: Python 3.11+
Framework: FastAPI 0.109+

Dependencies:
  # Web
  - fastapi
  - uvicorn[standard]
  - websockets
  - python-multipart

  # Database
  - sqlalchemy
  - alembic
  - asyncpg
  - psycopg2-binary

  # Vector DB
  - qdrant-client

  # Redis
  - redis
  - aioredis

  # Task Queue
  - celery[redis]
  - flower  # Monitoring

  # AI/ML
  - ollama  # Client
  - sentence-transformers
  - langchain
  - langchain-community

  # Utils
  - pydantic
  - pyyaml
  - python-dotenv
  - httpx
  - aiofiles

  # Observability
  - opentelemetry-api
  - opentelemetry-sdk
  - opentelemetry-instrumentation-fastapi
  - prometheus-client

  # Security
  - python-jose[cryptography]
  - passlib[bcrypt]
  - cryptography

  # E-mail
  - google-auth
  - google-auth-oauthlib
  - google-api-python-client
  - msal  # Microsoft

  # WhatsApp
  - twilio

  # Testing
  - pytest
  - pytest-asyncio
  - pytest-cov
  - httpx-mock
```

### Frontend

```yaml
Language: TypeScript 5+
Framework: Next.js 14

Dependencies:
  # Core
  - next
  - react
  - react-dom

  # UI
  - tailwindcss
  - @shadcn/ui
  - lucide-react  # Icons
  - framer-motion  # Animations

  # Ã‰tat
  - zustand
  - swr

  # Forms
  - react-hook-form
  - zod

  # Charts
  - recharts
  - victory

  # Utils
  - axios
  - date-fns
  - clsx
  - tailwind-merge

  # WebSocket
  - socket.io-client

  # Audio
  - wavesurfer.js

  # Testing
  - vitest
  - @testing-library/react
  - playwright
```

### Infrastructure

```yaml
Containers: Docker + Docker Compose

Services:
  ollama:
    image: ollama/ollama:latest
    gpu: required (NVIDIA)
    memory: 16GB+ recommended

  postgres:
    image: postgres:16-alpine
    version: 16.1

  qdrant:
    image: qdrant/qdrant:latest
    version: 1.7+

  redis:
    image: redis:7-alpine
    version: 7.2

  minio:
    image: minio/minio:latest

  jaeger:
    image: jaegertracing/all-in-one:latest

  prometheus:
    image: prom/prometheus:latest

  grafana:
    image: grafana/grafana:latest
```

---

## 5. Base de DonnÃ©es

### PostgreSQL Schema

```sql
-- Agents
CREATE TABLE agents (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    domain VARCHAR(50) NOT NULL,
    kind VARCHAR(100) NOT NULL,
    skills JSONB NOT NULL DEFAULT '[]',
    owner_id UUID REFERENCES users(id),
    policy_id UUID REFERENCES policies(id),
    config JSONB NOT NULL DEFAULT '{}',
    status VARCHAR(20) NOT NULL DEFAULT 'created',
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW(),
    deleted_at TIMESTAMP
);

-- Orchestrators
CREATE TABLE orchestrators (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    scope VARCHAR(50) NOT NULL,
    max_agents INTEGER NOT NULL DEFAULT 10,
    rules JSONB NOT NULL DEFAULT '{}',
    status VARCHAR(20) NOT NULL DEFAULT 'active',
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

-- Events (Audit Trail)
CREATE TABLE events (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    ts TIMESTAMP NOT NULL DEFAULT NOW(),
    source VARCHAR(255) NOT NULL,
    type VARCHAR(100) NOT NULL,
    agent_id UUID REFERENCES agents(id),
    user_id UUID REFERENCES users(id),
    payload JSONB NOT NULL DEFAULT '{}',
    indexed BOOLEAN DEFAULT FALSE
);

-- Documents
CREATE TABLE documents (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    kind VARCHAR(50) NOT NULL,
    title VARCHAR(500),
    path VARCHAR(1000),
    meta JSONB NOT NULL DEFAULT '{}',
    embedded BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

-- E-mails
CREATE TABLE emails (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    account_id UUID NOT NULL,
    thread_id VARCHAR(255) NOT NULL,
    subject TEXT,
    body TEXT,
    from_email VARCHAR(255),
    to_emails JSONB,
    labels JSONB DEFAULT '[]',
    priority VARCHAR(20),
    theme VARCHAR(50),
    sentiment VARCHAR(20),
    received_at TIMESTAMP,
    indexed BOOLEAN DEFAULT FALSE,
    UNIQUE(account_id, thread_id)
);

-- Health Logs (Coach)
CREATE TABLE health_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    ts TIMESTAMP NOT NULL DEFAULT NOW(),
    type VARCHAR(50) NOT NULL,  -- weight, calories_in, calories_out, activity
    value NUMERIC NOT NULL,
    unit VARCHAR(20),
    note TEXT,
    source VARCHAR(50) DEFAULT 'whatsapp'
);

-- Reports
CREATE TABLE reports (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    kind VARCHAR(50) NOT NULL,  -- coach_daily, coach_weekly, meeting_cr
    period VARCHAR(50),
    path VARCHAR(1000),
    meta JSONB NOT NULL DEFAULT '{}',
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

-- Templates
CREATE TABLE templates (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    category VARCHAR(50) NOT NULL,  -- cr, email, academic
    format VARCHAR(20) NOT NULL,  -- markdown, latex, docx
    body TEXT NOT NULL,
    variables JSONB DEFAULT '[]',
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

-- Users
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) NOT NULL UNIQUE,
    password_hash VARCHAR(255),
    role VARCHAR(20) NOT NULL DEFAULT 'user',  -- admin, power_user, user
    settings JSONB DEFAULT '{}',
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

-- Policies
CREATE TABLE policies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    rules JSONB NOT NULL DEFAULT '{}',
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);
```

### Qdrant Collections

```python
collections = [
    {
        "name": "agenticai_rag",
        "vector_size": 768,  # nomic-embed-text dimension
        "distance": "Cosine",
        "payload_schema": {
            "doc_id": "keyword",
            "chunk_id": "integer",
            "text": "text",
            "source": "keyword",
            "timestamp": "datetime"
        }
    },
    {
        "name": "voice_transcripts",
        "vector_size": 768,
        "distance": "Cosine",
        "payload_schema": {
            "session_id": "keyword",
            "speaker": "keyword",
            "timestamp": "datetime",
            "language": "keyword",
            "text": "text"
        }
    },
    {
        "name": "mail_threads",
        "vector_size": 768,
        "distance": "Cosine",
        "payload_schema": {
            "thread_id": "keyword",
            "account_id": "keyword",
            "subject": "text",
            "labels": "keyword[]",
            "received_at": "datetime"
        }
    }
]
```

---

**Suite dans le prochain message (Orchestration, SÃ©curitÃ©, DÃ©ploiement)...**

Veux-tu que je continue avec la suite de l'architecture ou tu as des questions sur ce que je viens de prÃ©senter?

## Cahier des charges â€“ Assistant IA Agentique (v1.0)

Plateforme multi-agents 100% locale (LLM/embeddings/ASR via Ollama), extensible, pilotÃ©e par orchestrateurs, avec monitoring de la donnÃ©e, auto-Ã©valuation, crÃ©ation de features par chat, et intÃ©grations (mail, WhatsApp, Ã©cran, web).

---

### 1. Vision & pÃ©rimÃ¨tre
- Objectif : bÃ¢tir un assistant Â« agentique Â» modulaire oÃ¹ chaque feature = 1..n agents spÃ©cialisÃ©s, coordonnÃ©s par des sous-orchestrateurs et un orchestrateur master.
- Principe : lâ€™orchestration crÃ©e/ajuste/supprime des agents de faÃ§on autonome, sur la base des mÃ©triques (qualitÃ©, latence, dÃ©rive) et des politiques.
- ExpÃ©rience : tout dÃ©marre par WhatsApp ou le chat web. Lâ€™utilisateur dÃ©crit son besoin â†’ le systÃ¨me conÃ§oit, propose, implÃ©mente (avec tests) â†’ lâ€™IHM sâ€™actualise.
- Contrainte clÃ© : modÃ¨les IA locaux via Ollama (LLM/embeddings/whisper). Connecteurs autorisÃ©s : Gmail/Outlook/WhatsApp/Calendriers/Drive internes si nÃ©cessaires.

### 2. Cas dâ€™usage prioritaires
1. RÃ©union temps rÃ©el : capture audio â†’ transcription (ASR), traduction live, Q&A avec RAG minute-par-minute, marqueurs Â« Action/DÃ©cision Â».
2. E-mail : ingestion + classement + synthÃ¨se + rÃ©daction + envoi (HITL).
3. Chat agentique : commandes naturelles pour crÃ©er agents/UI/workflows/tests.
4. Coach SantÃ© : logs via WhatsApp (kcal/poids/sport) â†’ reporting & recommandations.
5. Comptes-rendus (CR) : Ã  partir de transcript/puces â†’ template (MD/LaTeX/Docx).
6. Capture dâ€™Ã©cran : OCR + comprÃ©hension de contexte + overlays (traduire, rÃ©sumer, extraire).
7. Web Intelligence (nouveau) : collecte dâ€™infos utiles sur Internet pour nourrir tous les agents, avec citations et contrÃ´le de conformitÃ©.
8. RÃ©dacteur acadÃ©mique (nouveau) : mÃ©moire/rapports acadÃ©miques avec agent de relecture anti-hallucinations & vÃ©rifications croisÃ©es.
9. PM IT (nouveau) : copilote chef de projet (rituels agiles, risques, RCAs, RACI, reporting CODIR, planningâ€¦).

### 3. Architecture (vue dâ€™ensemble)
- Interface : Web (Next.js/React ou Django+HTMX), widget rÃ©union live, bot WhatsApp.
- Orchestration : Orchestrateur master + sous-orchestrateurs par domaine (Voix, Mail, RAG/Chat, SantÃ©, CR, WebIntel, PM).
- Agents : micro-services spÃ©cialisÃ©s (stateless), dÃ©clarÃ©s dans un Registry.
- IA locale : Ollama (LLM/embeddings), whisper pour ASR, OCR local.
- DonnÃ©es : PostgreSQL (Ã©tat), Qdrant/Chroma (vecteurs), MinIO (fichiers).
- Messaging : NATS ou Redis Streams.
- Workers/Workflows : Celery/Temporal/Prefect.
- ObservabilitÃ© : OpenTelemetry, dashboards, journaux structurÃ©s.
- SÃ©curitÃ© : RBAC, Vault secrets, chiffrement, audit trail.

### 4. Orchestration & gouvernance
- Orchestrateur master : priorisation globale, arbitrage ressources, application des politiques (quotas, garde-fous).
- Sous-orchestrateurs : portÃ©s par domaine, traduisent une demande en plan dâ€™exÃ©cution (graphes), peuvent proposer la crÃ©ation dâ€™agents/UI/tests.
- Garde-fous : quotas de crÃ©ation dâ€™agents, autorisations par scope, HITL pour actions sensibles (envoi mail externe, partage document, changement de politique).
- TraÃ§abilitÃ© : chaque dÃ©cision dâ€™orchestration est expliquÃ©e (inputs â†’ plan â†’ rÃ©sultats), consultable dans lâ€™IHM.

### 5. Agents (exemples par domaine)
- Voix : Voice.Capture, Voice.Transcribe (whisper), Voice.Translate, Voice.QA (RAG), Voice.Summarizer.
- E-mail : Mail.Ingest (OAuth), Mail.Classify, Mail.Summarize, Mail.ReplyDraft, Mail.Sender (HITL), Mail.ThreadIndexer.
- RAG/Chat : RAG.Indexer, RAG.Searcher, Chat.Router, Chat.AgentCreator.
- SantÃ© : Coach.LogIngest, Coach.Analyst, Coach.Reporter, Coach.Recommender.
- CR/Docs : CR.Builder, CR.DecisionExtractor, Docs.Formatter (LaTeX/Docx), Docs.Citer (citations/biblio), Docs.PlagiarismLocal.
- Screen : Screen.Capture, Screen.OCR, Screen.Context, Screen.Overlay.
- Web Intelligence : Web.Crawler, Web.Focuser (requÃªtes ciblÃ©es), Web.Extractor (schÃ©mas), Web.FactChecker, Web.CitationStore.
- PM IT : PM.StandupSummarizer, PM.RiskMiner, PM.DependencyGrapher, PM.BurnupCoach, PM.RACI.Suggester, PM.Report.CODIR, PM.ScopeImpact, PM.Retros.Analyst.

### 6. Flux majeurs (sÃ©quences cibles)

#### 6.1 RÃ©union Teams â€“ transcription/traduction/Q&A live
1. Voice.Capture â†’ paquets audio 1â€“2 s (VAD).
2. Voice.Transcribe (whisper local) â†’ texte horodatÃ©.
3. Voice.Translate â†’ langue cible.
4. RAG.Indexer ingÃ¨re au fil de lâ€™eau.
5. Voice.QA rÃ©pond via chat (citations avec timecodes).
6. Export transcript + chapitrage + marqueurs.

#### 6.2 E-mail â€“ ingestion â†’ synthÃ¨se â†’ rÃ©ponse
1. Mail.Ingest (Gmail/Outlook, scopes minimaux).
2. Mail.Classify (prioritÃ©, thÃ¨me).
3. Mail.Summarize (bullets, risques, next steps).
4. Mail.ReplyDraft â†’ validation humaine â†’ Mail.Sender.
5. Indexation utile (RAG) + mÃ©triques monitoring.

#### 6.3 Chat â†’ Feature/Agent/UI (crÃ©ation naturelle)
- Lâ€™utilisateur dÃ©crit. Chat.AgentCreator gÃ©nÃ¨re la spec (agents, endpoints, tests, widgets, KPIs).
- Builder.Orchestrator dÃ©ploie et exÃ©cute les tests.
- Lâ€™IHM se met Ã  jour (hot-reload composants).

#### 6.4 Coach SantÃ© via WhatsApp
- Coach.LogIngest parse messages libres (kcal/poids/sport).
- Coach.Analyst calcule bilans et tendances.
- Coach.Reporter publie quotidien/hebdo/mensuel.
- Coach.Recommender alerte et propose des ajustements.

#### 6.5 CR & documents
- Input : transcript/puces/sources.
- CR.Builder + Docs.Formatter â†’ PDF/LaTeX/MD/Docx.
- Docs.Citer gÃ¨re bibliographie (BibTeX/CSL).
- Docs.Reviewer (anti-hallucinations) valide les assertions avec preuves.

#### 6.6 Web Intelligence
- Web.Focuser reÃ§oit un besoin (Â« cartographier subventions IA Maroc 2024â€“2025 Â»).
- Web.Crawler collecte (robots.txt, rate-limit).
- Web.Extractor structure (titres, auteurs, dates, passages clÃ©s).
- Web.FactChecker confronte sources, score confiance.
- Web.CitationStore garde URLs/extraits + hash.
- RÃ©sumÃ©s & alertes vers agents consommateurs (RAG, CR, PM).

### 7. IHM (exigences)
- Dashboard par domaine (RÃ©unions, E-mails, SantÃ©, Docs, WebIntel, PM).
- Panneau live (sous-titres, langue, marqueurs Action/DÃ©cision).
- Chat latÃ©ral (RAG + commandes agentiques).
- BoÃ®te dâ€™envoi (Brouillon/Relecture/Envoi).
- Rapports SantÃ© : courbes, heatmaps, objectifs.
- WebIntel : carte sources, extraits, citations.
- PM : risques, burndown/burnup, dÃ©pendances (graph), dÃ©cisions, RAID log.
- Styles : sombre/clair, responsive, accessibilitÃ©.

### 8. Monitoring & Data Quality
- Ce quâ€™on mesure : complÃ©tude, duplicats, schÃ©ma, dÃ©rive sÃ©mantique (embeddings), latence, WER, prÃ©cision classif, faithfulness RAG, satisfaction (ratings).
- Pipeline : Monitor.Collector â†’ Monitor.Validator â†’ Monitor.Drift â†’ Monitor.Insights â†’ Monitor.ActionPlanner.
- Actions auto : A/B tests, changement de modÃ¨le, crÃ©ation dâ€™agent de mitigation, retuning chunking RAG, rÃ©-indexation ciblÃ©e.
- RÃ¨gles (YAML) paramÃ©trables par domaine.

### 9. Auto-Ã©valuation, A/B tests & sÃ©lection de modÃ¨les
- Golden sets versionnÃ©s par domaine.
- AB tests dÃ©clenchÃ©s automatiquement si KPI < seuil.
- Canary (10%) â†’ promotion si > baseline.
- Politiques modÃ¨les : candidats par tÃ¢che, contraintes (latence, VRAM), forbid cloud.
- Journalisation de tous les switchs et motifs.

### 10. Choix du LLM par agent/orchestrateur
- UI : sÃ©lection LLM primaire, fallbacks, profil (qualitÃ©/latence).
- Overrides par sous-tÃ¢che (ex. traduction vs synthÃ¨se).
- Auto-switch sur violation SLA rÃ©currente.

### 11. Web Intelligence â€“ exigences dÃ©taillÃ©es (nouveau)
- Collecte : headless browser local, respect robots.txt, user-agent dÃ©diÃ©, rate-limit, cache.
- Extraction : parse HTML/PDF (screenshot â†’ OCR si besoin), normalisation (titres, auteurs, dates, rÃ©sumÃ©, passages).
- Ã‰thique & conformitÃ© : citer les sources, stocker hash/URL/date, Ã©viter contenus protÃ©gÃ©s non citables, filtres NSFW.
- Anti-hallucinations : toute affirmation issue du web doit lier au passage source.
- API : /webintel/query, /webintel/brief, /webintel/corpus/{topic}.
- IntÃ©gration : agents consommateurs (Docs, PM, CR, RAG) reÃ§oivent briefs sourcÃ©s.

### 12. RÃ©dacteur acadÃ©mique & relecteur anti-hallucinations (nouveau)
- Pipeline :
  1. Scoping (objectif, audience, normes, bibliostyle),
  2. Plan guidÃ© (titres, hypothÃ¨ses, contributions),
  3. Draft sectionnÃ© (chaque paragraphe avec preuves liÃ©es),
  4. Citations (BibTeX/CSL),
  5. Relecture (style, cohÃ©rence, anti-plagiat local),
  6. VÃ©rification factuelle par Docs.Reviewer (liens vers sources),
  7. Compilation (LaTeX/PDF/Docx),
  8. Check final (liste de contrÃ´le).
- Agents : Docs.Outliner, Docs.Drafter, Docs.Citer, Docs.Reviewer, Docs.Style, Docs.Compiler.
- Exigence majeure : toute assertion doit pointer vers une preuve (source interne/externe) ; sinon marquÃ©e Ã  vÃ©rifier.
- Sorties : version longue + exÃ©cutive, annexes (tableaux/figures), bibliographie.

### 13. Copilote PM IT (nouveau)
- Rituels : standups auto-rÃ©sumÃ©s, minutes de meetings, dÃ©cisions, actions.
- Risques : PM.RiskMiner scanne mails/notes/tickets â†’ heatmap risques + plans de mitigation.
- DÃ©pendances : PM.DependencyGrapher (tickets/epics) â†’ graph interactif.
- Charges & avancement : burndown/burnup, vÃ©locitÃ©, WIP, prÃ©dictions simples.
- Reporting : CODIR pack (tableau de bord + commentaires gÃ©nÃ©rÃ©s).
- Gouvernance : RACI suggÃ©rÃ©, gestion des dÃ©cisions (registre), Scope Impact (analyse des changements).
- IntÃ©grations : Jira/Azure DevOps/YouTrack (API), Calendrier, Drive.
- Commandes (chat) : â€œprÃ©pare la note de cadrageâ€, â€œcrÃ©e le plan de commsâ€, â€œsimule lâ€™impact dâ€™un staff-down de 20%â€.

### 14. API (extraits)
- POST /voice/session, WS /voice/stream, GET /voice/live, POST /voice/bookmark.
- POST /mail/summarize, POST /mail/reply, POST /mail/send (HITL).
- POST /coach/log, GET /coach/report?period=week.
- POST /cr/build, POST /docs/compile.
- POST /agents/create, GET /agents, DELETE /agents/{id}.
- POST /orchestrator/policy, GET /trace/{id}.
- POST /webintel/query, GET /webintel/brief.
- POST /pm/risks/analyze, GET /pm/report/codir.

### 15. DonnÃ©es & schÃ©mas (principal)
- agents(id, name, kind, skills[], owner, policy_id, status, created_at)
- orchestrators(id, scope, max_agents, rules_json)
- events(id, ts, source, type, payload_json)
- documents(id, kind, path, meta_json, embedded)
- vectors(id, doc_id, chunk_id, embedding, meta)
- emails(account_id, thread_id, meta, body, labels[])
- health_logs(ts, type, value, note)
- reports(id, kind, period, path, meta)
- templates(id, name, format, body, variables[])
- evaluations(id, agent_id, dataset_id, metric, value, ts)
- ab_tests(id, scope, candidates[], winner, metrics_json, ts)
- proposals(id, kind, detail_json, status, created_by, ts)
- screenshots(id, path, ocr_text, app, title, meta_json, ts)
- citations(id, doc_id, url, hash, title, author, date, snippet)

### 16. SÃ©curitÃ© & conformitÃ©
- DonnÃ©es locales par dÃ©faut, secrets en Vault, chiffrement au repos/en transit.
- RBAC (Admin/Power user/User), audit trail (toutes actions sensibles).
- Masquage PII sur captures dâ€™Ã©cran (cÃ´tÃ© client).
- Politique WhatsApp : opt-in clair, logs consultables, suppression Ã  la demande.
- Journalisation des accÃ¨s API (mail, calendriers, Jira, etc.).

### 17. KPI, SLA & objectifs qualitÃ©
- Voix : WER â‰¤ 18% (calme), latence phrase-Ã -phrase â‰¤ 3 s, traduction +1 s max.
- E-mail : prÃ©cision classif â‰¥ 87%, synthÃ¨se < 3â€“5 s, satisfaction â‰¥ 4/5.
- RAG : P@1 â‰¥ 75%, rÃ©ponses citÃ©es â‰¥ 95%.
- Docs : conformitÃ© style â‰¥ 95%, assertions non sourcÃ©es = signalÃ©es.
- WebIntel : 100% Ã©lÃ©ments clÃ©s citables (URL + extrait).
- PM : couverture dÃ©cisions â‰¥ 90%, dÃ©lais minutes < 10 min.

### 18. Tests & qualitÃ©
- Unitaires par agent, contrats connecteurs, intÃ©gration par domaine.
- Non-rÃ©gression sur golden sets (Voix, E-mail, RAG, Docs, PM).
- Tests agentiques (crÃ©ation dynamique, quotas, garde-fous).
- SÃ©curitÃ© (scopes, RBAC, chiffrement).
- Performance (latence, throughput, VRAM).

### 19. DÃ©ploiement & opÃ©rations
- Docker Compose (Ollama + API + DB + VectorDB + MinIO + Redis/NATS + Front).
- Profils CPU/GPU (whisper/LLM), volumes chiffrÃ©s, backups & restauration.
- Mise Ã  jour modÃ¨les par tags versionnÃ©s, rollback possible.

### 20. Politiques dâ€™orchestration (exemple YAML)
```yaml
orchestrator:
  max_concurrent_agents: 12
  creation_rate_limit_per_min: 3
  guarded_actions: ["send_email_external", "share_file", "change_policies"]
  require_human_approval: ["send_email_external", "create_sub_orchestrator"]
models_policy:
  default_llm_candidates: ["llama3:8b-instruct", "qwen2.5:7b-instruct", "mistral:7b-instruct"]
  embedding: "nomic-embed-text"
  constraints:
    forbid_cloud: true
    max_vram_gb: 10
monitoring:
  rag:
    p_at_1_min: 0.75
    actions_if_breach: ["enable_hybrid_search", "increase_chunk_size", "ab_test_models"]
  asr:
    max_wer: 0.18
    max_latency_ms: 3000
    actions_if_breach: ["switch_whisper_variant", "noise_suppression"]
  email_classification:
    target_precision: 0.87
    auto_mitigations:
      - if: "precision < 0.80"; then: "create_agent: Mail.PriorityBooster"
      - if: "precision between 0.80 and 0.87"; then: "enable_ab_test: ['llama3','qwen2.5']"
```

### 21. Roadmap (8 semaines)
- S1â€“S2 : Monitoring core + dashboards ; policies modÃ¨les ; skeleton A/B.
- S3 : Chatâ†’Feature (Designer/Builder) + UI hot-reload.
- S4 : WhatsApp Router + Coach complet.
- S5 : Screen Intelligence (capture + OCR + overlay).
- S6 : Web Intelligence (crawler + fact-check + citations).
- S7 : RÃ©dacteur acadÃ©mique + Reviewer anti-hallucinations.
- S8 : Copilote PM (risques, dÃ©cisions, reporting) + durcissement sÃ©cu.

### 22. Livrables
- OpenAPI (API), schemas DB + migrations, registry agents (YAML).
- Policies (monitoring, modÃ¨les), golden sets (Voix/E-mail/RAG/Docs/PM).
- Templates CR/Docs (LaTeX/MD/Docx), exemples de prompts.
- Playbooks (opÃ©rations, sauvegardes, MAJ modÃ¨les).
- Tableaux de bord (latence, WER, prÃ©cision, dÃ©rive, adoption).
- Guide utilisateur (chatâ†’feature, WhatsApp, UI widgets).

### 23. Non-fonctionnels
- DisponibilitÃ© locale â‰¥ 99%.
- TTM â€œchatâ†’prodâ€ petit agent/UI < 10 min.
- Performances : objectifs section KPI.
- Ã‰volutivitÃ© : ajout dâ€™agents sans arrÃªt global (rolling).
- PortabilitÃ© : Linux/Windows/macOS, GPU facultatif (recommandÃ©).
- SÃ©cu : RBAC, chiffrement, audit complet.

### 24. Annexes

#### 24.1 Exemples de commandes (chat)
- Â« Ajoute un agent qui extrait les to-dos dans mes mails, crÃ©e un widget â€˜To-Do Inboxâ€™, et envoie chaque matin Ã  8h un rappel. Â»
- Â« PrÃ©pare un CR exÃ©cutif de la rÃ©union dâ€™aujourdâ€™hui avec sections DÃ©cisions/Actions/Risques, export PDF. Â»
- Â« Sur Mail.Summarize, lance un A/B llama3 vs qwen2.5 pendant 3 jours. Â»
- Â« WebIntel : fais un brief sourcÃ© sur â€˜subventions IA au Maroc 2025â€™ avec 5 sources fiables. Â»
- Â« PM : gÃ©nÃ¨re un RACI pour le projet ADV Email Assistant et propose un plan de com. Â»

#### 24.2 Grille de relecture (anti-hallucinations)
- Assertion â†” preuve ? (URL interne/externe ou citation RAG).
- Style conforme ? (norme acadÃ©mique adoptÃ©e).
- Chiffres & dates cohÃ©rents ?
- Plagiat local ? SimilaritÃ© < seuil.

#### 24.3 Templates (extrait CR)
- Contexte | DÃ©cisions | Actions (Owner, Due) | Risques | Annexes | Liens.

### 25. Ã€ valider
- Choix stack UI (Next.js/React vs Django+HTMX).
- Vector DB (Qdrant vs Chroma).
- Liste modÃ¨les Ollama (LLM + embeddings + whisper variante).
- FrÃ©quence des recommandations (quotidien 18:00 ? hebdo ven 17:00 ?).
- Seuils initiaux monitoring par domaine.
- IntÃ©grations PM (Jira/Azure DevOps/YouTrack) et comptes e-mail.

Fin v1.0.
